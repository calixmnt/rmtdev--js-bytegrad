(()=>{"use strict";const e=document.querySelector(".bookmarks-btn"),t=document.querySelector(".error"),o=document.querySelector(".error__text"),s=document.querySelector(".job-details"),n=document.querySelector(".job-details__content"),i=document.querySelector(".job-list--bookmarks"),a=document.querySelector(".job-list--search"),c=(document.querySelector(".job-list--empty"),document.querySelector(".count__number")),r=document.querySelector(".pagination"),l=document.querySelector(".pagination__button--next"),b=document.querySelector(".pagination__button--back"),d=document.querySelector(".pagination__number--next"),m=document.querySelector(".pagination__number--back"),_=document.querySelector(".search"),u=document.querySelector(".search__input"),v=document.querySelector(".sorting"),g=document.querySelector(".sorting__button--relevant"),f=document.querySelector(".sorting__button--recent"),h=document.querySelector(".spinner--search"),p=document.querySelector(".spinner--job-details"),j="https://bytegrad.com/course-assets/js/2/api",k={searchJobItems:[],activeJobItem:{},bookmarkJobItems:[],currentPage:1},y=async e=>{const t=await fetch(e),o=await t.json();if(!t.ok)throw new Error(o.description);return o},L=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An error occured",s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3500;o.textContent=e,t.classList.add("error--visible"),setTimeout((()=>t.classList.remove("error--visible")),s)},I=e=>{const t=`\n                  <img src="${e.coverImgURL}" alt="#" class="job-details__cover-img">\n  \n                  <a class="apply-btn" href="${e.companyURL}" target="_blank">Apply <i class="fa-solid fa-square-arrow-up-right apply-btn__icon"></i></a>\n  \n                  <section class="job-info">\n                      <div class="job-info__left">\n                          <div class="job-info__badge">${e.badgeLetters}</div>\n                          <div class="job-info__below-badge">\n                              <time class="job-info__time">${e.daysAgo}d</time>\n                              <button class="job-info__bookmark-btn">\n                                  <i class="fa-solid fa-bookmark job-info__bookmark-icon"></i>\n                              </button>\n                          </div>\n                      </div>\n                      <div class="job-info__right">\n                          <h2 class="second-heading">${e.title}</h2>\n                          <p class="job-info__company">${e.company}</p>\n                          <p class="job-info__description">${e.description}</p>\n                          <div class="job-info__extras">\n                              <p class="job-info__extra"><i class="fa-solid fa-clock job-info__extra-icon"></i> ${e.duration}</p>\n                              <p class="job-info__extra"><i class="fa-solid fa-money-bill job-info__extra-icon"></i> ${e.salary}</p>\n                              <p class="job-info__extra"><i class="fa-solid fa-location-dot job-info__extra-icon"></i> ${e.location}</p>\n                          </div>\n                      </div>\n                  </section>\n  \n                  <div class="job-details__other">\n                      <section class="qualifications">\n                          <div class="qualifications__left">\n                              <h4 class="fourth-heading">Qualifications</h4>\n                              <p class="qualifications__sub-text">Other qualifications may apply</p>\n                          </div>\n                          <ul class="qualifications__list">\n                              ${e.qualifications.map((e=>`<li class="qualifications__item">${e}</li>`)).join("")}\n                          </ul>\n                      </section>\n                      \n                      <section class="reviews">\n                          <div class="reviews__left">\n                              <h4 class="fourth-heading">Company reviews</h4>\n                              <p class="reviews__sub-text">Recent things people are saying</p>\n                          </div>\n                          <ul class="reviews__list">\n                              ${e.reviews.map((e=>`<li class="reviews__item">${e}</li>`)).join("")}\n                          </ul>\n                      </section>\n                  </div>\n  \n                  <footer class="job-details__footer">\n                      <p class="job-details__footer-text">If possible, please reference that you found the job on <span class="u-bold">rmtDev</span>, we would really appreciate it!</p>\n                  </footer>\n      `;n.innerHTML=t},q=e=>{("search"===e?h:p).classList.toggle("spinner--visible")},S=async e=>{e.preventDefault();const t=e.target.closest(".job-item");document.querySelectorAll(".job-item--active").forEach((e=>{e.classList.remove("job-item--active")})),t.classList.add("job-item--active"),n.innerHTML="",q("job-details");const o=t.children[0].getAttribute("href"),s=[...k.searchJobItems,...k.bookmarkJobItems];k.activeJobItem=s.find((e=>e.id===+o)),history.pushState(null,"",`/#${o}`);try{const e=await y(`${j}/jobs/${o}`),{jobItem:t}=e;q("job-details"),I(t)}catch(e){q("job-details"),L(e)}};a.addEventListener("click",S),i.addEventListener("click",S);const $=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"search";const t="search"===e?a:i;let o;t.innerHTML="","search"===e?o=k.searchJobItems.slice(7*(k.currentPage-1),7*k.currentPage):"bookmarks"===e&&(o=k.bookmarkJobItems),o.forEach((e=>{const o=`\n        <li class="job-item ${k.activeJobItem.id===e.id&&"job-item--active"}">\n            <a class="job-item__link" href="${e.id}">\n                <div class="job-item__badge">${e.badgeLetters}</div>\n                <div class="job-item__middle">\n                    <h3 class="third-heading">${e.title}</h3>\n                    <p class="job-item__company">${e.company}</p>\n                    <div class="job-item__extras">\n                        <p class="job-item__extra"><i class="fa-solid fa-clock job-item__extra-icon"></i>${e.duration}</p>\n                        <p class="job-item__extra"><i class="fa-solid fa-money-bill job-item__extra-icon"></i>${e.salary}</p>\n                        <p class="job-item__extra"><i class="fa-solid fa-location-dot job-item__extra-icon"></i>${e.location}</p>\n                    </div>\n                </div>\n                <div class="job-item__right">\n                    <i class="fa-solid fa-bookmark job-item__bookmark-icon"></i>\n                    <time class="job-item__time">${e.daysAgo}d</time>\n                </div>\n            </a>\n        </li>`,s=(new DOMParser).parseFromString(o,"text/html").body.firstChild;t.insertAdjacentElement("beforeend",s)}))},J=()=>{k.currentPage>=2?b.classList.remove("pagination__button--hidden"):b.classList.add("pagination__button--hidden"),k.searchJobItems.length-7*k.currentPage<=0?l.classList.add("pagination__button--hidden"):l.classList.remove("pagination__button--hidden"),d.textContent=k.currentPage+1,m.textContent=k.currentPage-1,l.blur(),b.blur()};r.addEventListener("click",(e=>{const t=e.target.closest(".pagination__button");console.log(t),t&&(t.className.includes("--next")?k.currentPage++:k.currentPage--,J(),$())}));const x=J;_.addEventListener("submit",(async e=>{e.preventDefault();const t=u.value;if(/[0-9]/.test(t))L("Your search may not content numbers",3500);else{u.blur(),a.innerHTML="",f.classList.remove("sorting__button--active"),g.classList.add("sorting__button--active"),q("search");try{const e=await y(`${j}/jobs?search=${t}`),{jobItems:o}=e;k.searchJobItems=o,k.currentPage=1,q("search"),c.textContent=k.searchJobItems.length,x(),$()}catch(e){q("search"),L(e.message,3500)}}})),v.addEventListener("click",(e=>{const t=e.target.closest(".sorting__button");if(!t)return;k.currentPage=1;const o=t.classList.contains("sorting__button--recent");o?(f.classList.add("sorting__button--active"),g.classList.remove("sorting__button--active")):(f.classList.remove("sorting__button--active"),g.classList.add("sorting__button--active")),o?k.searchJobItems.sort(((e,t)=>e.daysAgo-t.daysAgo)):k.searchJobItems.sort(((e,t)=>t.relevanceScore-e.relevanceScore)),x(),$()}));const w=async()=>{const e=window.location.hash.substring(1);if(e){n.innerHTML="",q("job-details");try{const t=await y(`${j}/jobs/${e}`),{jobItem:o}=t;k.activeJobItem=o,q("job-details"),I(o)}catch(e){q("job-details"),L(e)}}};window.addEventListener("DOMContentLoaded",w),window.addEventListener("hashchange",w),s.addEventListener("click",(e=>{e.target.className.includes("bookmark")&&(k.bookmarkJobItems.some((e=>e.id===k.activeJobItem.id))?k.bookmarkJobItems=k.bookmarkJobItems.filter((e=>e.id!==k.activeJobItem.id)):k.bookmarkJobItems.push(k.activeJobItem),localStorage.setItem("bookmarkJobItems",JSON.stringify(k.bookmarkJobItems)),document.querySelector(".job-info__bookmark-icon").classList.toggle("job-info__bookmark-icon--bookmarked"))})),e.addEventListener("mouseenter",(()=>{e.classList.add("bookmarks-btn--active"),i.classList.add("job-list--visible"),$("bookmarks")})),i.addEventListener("mouseleave",(()=>{e.classList.remove("bookmarks-btn--active"),i.classList.remove("job-list--visible")}));const E=localStorage.getItem("bookmarkJobItems");E&&(k.bookmarkJobItems=JSON.parse(E))})();